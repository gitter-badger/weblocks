<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ChangeLog &#8212; weblocks/reblocks 0.30.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/yeti/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.30.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="weblocks/reblocks 0.30.0 documentation" href="index.html" />
    <link rel="prev" title="Hints" href="hints.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          weblocks/reblocks</a>
        <span class="navbar-text navbar-version pull-left"><b>0.30</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="#">Changelog</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components of Weblocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="stores.html">Stores</a></li>
<li class="toctree-l1"><a class="reference internal" href="widgets.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Request Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="forms.html">Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="continuations.html">Continuation-based tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependency handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="html.html">HTML generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="adapting.html">Adapting Weblocks to your needs</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Weblocks Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to Weblocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="hints.html">Hints</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ChangeLog</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">ChangeLog</a><ul>
<li><a class="reference internal" href="#id1">0.30.0 (2018-05-19)</a></li>
<li><a class="reference internal" href="#id2">0.29.0 (2018-05-05)</a><ul>
<li><a class="reference internal" href="#backward-incompatibilities">Backward incompatibilities</a></li>
<li><a class="reference internal" href="#improvements">Improvements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">0.28.0 (2018-04-23)</a></li>
<li><a class="reference internal" href="#id4">0.27.2 (2018-04-09)</a></li>
<li><a class="reference internal" href="#id5">0.27.1 (2018-04-09)</a></li>
<li><a class="reference internal" href="#id8">0.27.0 (2018-03-11)</a></li>
<li><a class="reference internal" href="#id9">0.26.0 (2018-02-20)</a></li>
<li><a class="reference internal" href="#id10">0.25.2 (2018-02-04)</a></li>
<li><a class="reference internal" href="#id11">0.25.1 (2018-02-04)</a></li>
<li><a class="reference internal" href="#id12">0.25.0 (2018-01-31)</a><ul>
<li><a class="reference internal" href="#good-news-everyone">Good news, everyone!</a></li>
<li><a class="reference internal" href="#widget-related-changes">Widget related changes</a></li>
<li><a class="reference internal" href="#actions-processing">Actions processing</a></li>
<li><a class="reference internal" href="#application-and-server-restarting">Application and server restarting</a></li>
<li><a class="reference internal" href="#session-initialization-changes">Session initialization changes</a></li>
<li><a class="reference internal" href="#debug">Debug</a></li>
<li><a class="reference internal" href="#removals">Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13">0.24.0 (2018-01-29)</a><ul>
<li><a class="reference internal" href="#widget-refactorings">Widget refactorings</a></li>
<li><a class="reference internal" href="#request-level">Request level</a></li>
<li><a class="reference internal" href="#request-handler">Request handler</a></li>
<li><a class="reference internal" href="#error-handler">Error handler</a></li>
<li><a class="reference internal" href="#application-level">Application level</a></li>
<li><a class="reference internal" href="#actions-and-commands">Actions and commands</a></li>
<li><a class="reference internal" href="#javascript">Javascript</a></li>
<li><a class="reference internal" href="#variables">Variables</a></li>
<li><a class="reference internal" href="#symbols-moved-from-weblocks-to-other-packages">Symbols moved from :weblocks to other packages</a><ul>
<li><a class="reference internal" href="#to-weblocks-widgets-dom">To :weblocks/widgets/dom</a></li>
<li><a class="reference internal" href="#to-weblocks-utils-uri">To :weblocks/utils/uri</a></li>
<li><a class="reference internal" href="#to-weblocks-linguistic-grammar">To :weblocks/linguistic/grammar</a></li>
<li><a class="reference internal" href="#to-weblocks-utils-warn">To weblocks/utils/warn</a></li>
<li><a class="reference internal" href="#to-weblocks-actions">To weblocks/actions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14">Removals</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id15">0.23.0 (2018-01-11)</a></li>
<li><a class="reference internal" href="#id16">0.22.2 (2018-01-07)</a></li>
<li><a class="reference internal" href="#id17">0.22.1 (2018-01-07)</a></li>
<li><a class="reference internal" href="#id18">0.22.0 (2018-01-06)</a></li>
<li><a class="reference internal" href="#id19">0.21.0 (2018-01-01)</a></li>
<li><a class="reference internal" href="#id20">0.20.1 (2017-12-20)</a></li>
<li><a class="reference internal" href="#id21">0.20.0 (2017-12-15)</a></li>
<li><a class="reference internal" href="#id22">0.19.2 (2017-11-29)</a></li>
<li><a class="reference internal" href="#id23">0.19.1 (2017-11-23)</a></li>
<li><a class="reference internal" href="#id24">0.19.0 (2017-11-13)</a></li>
<li><a class="reference internal" href="#id25">0.18.0 (2017-11-12)</a></li>
<li><a class="reference internal" href="#id26">0.17.2 (2017-11-11)</a></li>
<li><a class="reference internal" href="#id27">0.17.1 (2017-11-11)</a></li>
<li><a class="reference internal" href="#id28">0.17.0 (2017-11-11)</a></li>
<li><a class="reference internal" href="#id29">0.16.0 (2017-11-04)</a></li>
<li><a class="reference internal" href="#id30">0.15.0 (2017-11-03)</a></li>
<li><a class="reference internal" href="#id31">0.14.4 (2017-10-07)</a></li>
<li><a class="reference internal" href="#id32">0.14.3 (2017-09-23)</a></li>
<li><a class="reference internal" href="#id33">0.14.2 (2017-09-22)</a></li>
<li><a class="reference internal" href="#id34">0.14.1 (2017-09-22)</a></li>
<li><a class="reference internal" href="#id35">0.14.0 (2017-09-20)</a></li>
<li><a class="reference internal" href="#id36">0.13.11 (2017-09-12)</a></li>
<li><a class="reference internal" href="#id37">0.13.10 (2017-09-06)</a><ul>
<li><a class="reference internal" href="#changes-in-weblocks-request-hooks">Changes in weblocks.request-hooks:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id38">0.13.10 (2017-09-06)</a></li>
<li><a class="reference internal" href="#id39">0.13.9 (2017-09-02)</a></li>
<li><a class="reference internal" href="#id40">0.13.8 (2017-09-02)</a></li>
<li><a class="reference internal" href="#id41">0.13.7 (2017-04-15)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="changelog">
<h1>ChangeLog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>0.30.0 (2018-05-19)<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Next feature release">
<h2 style="margin-bottom: 0.3em;">Next feature release</h2><ul class="simple">
<li>[<span style="color: #A04040;">Bug</span>]<span>:</span><span> </span>Fixed the order of commands for frontend. Now they are returned in the chronological order.</li>
</ul>
</div>
</div>
<div class="section" id="id2">
<h2>0.29.0 (2018-05-05)<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="backward-incompatibilities">
<h3>Backward incompatibilities<a class="headerlink" href="#backward-incompatibilities" title="Permalink to this headline">¶</a></h3>
<p>Class <code class="docutils literal"><span class="pre">weblocks/dependencies:dependency</span></code> now requires that <code class="docutils literal"><span class="pre">type</span></code>
attribute shoulde be of type <code class="docutils literal"><span class="pre">(member</span> <span class="pre">:css</span> <span class="pre">:js</span> <span class="pre">:png</span> <span class="pre">:jpg</span> <span class="pre">:gif)</span></code></p>
<p>Also, functions <code class="docutils literal"><span class="pre">make-local-js-dependency</span></code>,
<code class="docutils literal"><span class="pre">make-local-css-dependency</span></code>, <code class="docutils literal"><span class="pre">make-local-image-dependency</span></code>,
<code class="docutils literal"><span class="pre">make-remote-js-dependency</span></code> and <code class="docutils literal"><span class="pre">make-remote-css-dependency</span></code> were
removed from package <code class="docutils literal"><span class="pre">weblocks/dependencies</span></code>. Use <code class="docutils literal"><span class="pre">make-dependency</span></code>
function, it will figure out which dependency type to create itself.</p>
</div>
<div class="section" id="improvements">
<h3>Improvements<a class="headerlink" href="#improvements" title="Permalink to this headline">¶</a></h3>
<p>A new function <code class="docutils literal"><span class="pre">weblocks/debug:get-session-value</span></code> was added. It can be
used to get values from the last session seen by weblocks.</p>
</div>
</div>
<div class="section" id="id3">
<h2>0.28.0 (2018-04-23)<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Error handling was fixed. Previously it aborted Woo&#8217;s worker thread and
break the server.</p>
<p>Variable <code class="docutils literal"><span class="pre">weblocks/variables::*catch-errors-p*</span></code> was renamed to
<code class="docutils literal"><span class="pre">weblocks/variables::*invoke-debugger-on-error*</span></code> and it&#8217;s value was
inverted. If this variable is True, then debugger will be
invoked. Otherwise - Weblocks will return 500 error page.</p>
<p>Argument <code class="docutils literal"><span class="pre">:invoke-debugger-on-errors</span></code> of <code class="docutils literal"><span class="pre">weblocks/debug:on</span></code>
function was renamed to <code class="docutils literal"><span class="pre">:invoke-debugger-on-error</span></code>.</p>
<p>Method <code class="docutils literal"><span class="pre">weblocks/error-handler:on-error</span></code> now is called when you abort
request processing from the debugger. It is called with current app as
the first argument and the <code class="docutils literal"><span class="pre">nil</span></code> instead of condition.</p>
</div>
<div class="section" id="id4">
<h2>0.27.2 (2018-04-09)<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Fixed a typo in  <code class="docutils literal"><span class="pre">string-widget</span></code> and <code class="docutils literal"><span class="pre">funcall-widget</span></code> package definitions.</p>
</div>
<div class="section" id="id5">
<h2>0.27.1 (2018-04-09)<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Now <code class="docutils literal"><span class="pre">string-widget</span></code> and <code class="docutils literal"><span class="pre">funcall-widget</span></code> depends on
<code class="docutils literal"><span class="pre">weblocks/widgets/base</span></code> instead of <a href="#id6"><span class="problematic" id="id7">``</span></a>weblocks/widget.</p>
</div>
<div class="section" id="id8">
<h2>0.27.0 (2018-03-11)<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>Reloading of the defapp definition now does not tries to restart an
application. Previously, restart caused the problem – when there is only
one application, whole Weblocks server was shut down. So, I&#8217;ve removed
this implicit action.</p>
<p>Code which logs action result on the client-side was improved.</p>
</div>
<div class="section" id="id9">
<h2>0.26.0 (2018-02-20)<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>Symbols <code class="docutils literal"><span class="pre">add-application-hook</span></code>, <code class="docutils literal"><span class="pre">add-request-hook</span></code>,
<code class="docutils literal"><span class="pre">add-session-hook</span></code>, <code class="docutils literal"><span class="pre">prepare-hooks</span></code> and <code class="docutils literal"><span class="pre">call-hook</span></code>
aren&#8217;t exported from <code class="docutils literal"><span class="pre">weblocks/hooks</span></code> anymore. Use new macro
<code class="docutils literal"><span class="pre">defhook</span></code> instead.</p>
<p>Here is how it works:</p>
<p>You use <code class="docutils literal"><span class="pre">defhook</span></code> as the toplevel form of your file if you want to define
a new hook. This macro will create few other macroses in
<code class="docutils literal"><span class="pre">weblocks/hooks</span></code> package and will export them. For example:</p>
<div class="code common-lisp highlight-common-lisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">defhook</span> <span class="nv">database-opened</span>
   <span class="s">&quot;This hook is called when your application opens a database.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This code will add these macroses into the <code class="docutils literal"><span class="pre">weblocks/hooks</span></code> package:
<code class="docutils literal"><span class="pre">on-session-hook-database-opened</span></code>,
<code class="docutils literal"><span class="pre">on-request-hook-database-opened</span></code>,
<code class="docutils literal"><span class="pre">on-application-hook-database-opened</span></code>,
<code class="docutils literal"><span class="pre">with-database-opened-hook</span></code> and
<code class="docutils literal"><span class="pre">call-database-opened-hook</span></code>.</p>
<p>You need to wrap code, which opens a database, with
<code class="docutils literal"><span class="pre">with-database-opened-hook</span></code>:</p>
<div class="code common-lisp highlight-common-lisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">weblocks/hooks:with-database-opened-hook</span> <span class="p">()</span>
   <span class="p">(</span><span class="nv">do-some-staff-to-open-database</span><span class="p">))</span>
</pre></div>
</div>
<p>And in any other piece of code, you can define callbacks, using one of
other three macroses:</p>
<div class="code common-lisp highlight-common-lisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">weblocks/hooks:on-session-hook-database-opened</span>
    <span class="nv">log-database-opening</span> <span class="p">()</span>

  <span class="p">(</span><span class="nv">weblocks/hooks:call-next-hook</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">log:info</span> <span class="s">&quot;Database was opened&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Usage of <code class="docutils literal"><span class="pre">defhook</span></code> macro gives more transparency to all defined hooks,
because all of them now visible as external symbols in
<code class="docutils literal"><span class="pre">weblocks/hooks</span></code> package.</p>
</div>
<div class="section" id="id10">
<h2>0.25.2 (2018-02-04)<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>System <code class="docutils literal"><span class="pre">weblocks/hooks</span></code> now depends on <code class="docutils literal"><span class="pre">log4cl</span></code> and
<code class="docutils literal"><span class="pre">metatilities</span></code>, because previously sometimes it was impossible to load <code class="docutils literal"><span class="pre">weblocks</span></code>.</p>
</div>
<div class="section" id="id11">
<h2>0.25.1 (2018-02-04)<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>Old tests for widgets, removed from core framework were removed.</p>
<p>Tests for widget&#8217;s MOP methods were ported to Rove.</p>
<p>Package <code class="docutils literal"><span class="pre">weblocks/utils/close</span></code> now loaded with main <code class="docutils literal"><span class="pre">:weblocks</span></code>
system.</p>
<p>Few old widget tests were removed.</p>
<p>Added function <code class="docutils literal"><span class="pre">weblocks/session:reset</span></code> which resets current session.</p>
</div>
<div class="section" id="id12">
<h2>0.25.0 (2018-01-31)<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<div class="section" id="good-news-everyone">
<h3>Good news, everyone!<a class="headerlink" href="#good-news-everyone" title="Permalink to this headline">¶</a></h3>
<p>Quickstart tutorial was fixed!</p>
</div>
<div class="section" id="widget-related-changes">
<h3>Widget related changes<a class="headerlink" href="#widget-related-changes" title="Permalink to this headline">¶</a></h3>
<p>Function <code class="docutils literal"><span class="pre">render-widget</span></code> was replaced with <code class="docutils literal"><span class="pre">weblocks/widget:render</span>
<span class="pre">:around</span></code> method. Method implementation were moved to
<code class="docutils literal"><span class="pre">weblocks/widgets/render-methods</span></code>.</p>
<p>Funcall-widget&#8217;s package was refactored to conform package inferred
requirements.</p>
</div>
<div class="section" id="actions-processing">
<h3>Actions processing<a class="headerlink" href="#actions-processing" title="Permalink to this headline">¶</a></h3>
<p>Function <code class="docutils literal"><span class="pre">make-js-action</span></code> was moved to <code class="docutils literal"><span class="pre">weblocks/actions</span></code> package.</p>
</div>
<div class="section" id="application-and-server-restarting">
<h3>Application and server restarting<a class="headerlink" href="#application-and-server-restarting" title="Permalink to this headline">¶</a></h3>
<p>Package <code class="docutils literal"><span class="pre">weblocks/app</span></code> now exports functions <code class="docutils literal"><span class="pre">stop</span></code> and <code class="docutils literal"><span class="pre">restart</span></code>.
Previously they were internal and were called like <code class="docutils literal"><span class="pre">stop-webapp</span></code> and
<code class="docutils literal"><span class="pre">restart-webapp</span></code>.</p>
<p>Package <code class="docutils literal"><span class="pre">weblocks/server</span></code> does not export <code class="docutils literal"><span class="pre">start-weblocks</span></code> and
<code class="docutils literal"><span class="pre">stop-weblocks</span></code> functions. They were replaced with just <code class="docutils literal"><span class="pre">start</span></code> and
<code class="docutils literal"><span class="pre">stop</span></code>. Also, it&#8217;s internal generics <code class="docutils literal"><span class="pre">start</span></code> and <code class="docutils literal"><span class="pre">stop</span></code> were
renamed and transformed to <code class="docutils literal"><span class="pre">start-server</span></code> and <code class="docutils literal"><span class="pre">stop-server</span></code>
functions.</p>
</div>
<div class="section" id="session-initialization-changes">
<h3>Session initialization changes<a class="headerlink" href="#session-initialization-changes" title="Permalink to this headline">¶</a></h3>
<p>File <code class="docutils literal"><span class="pre">default-application.lisp</span></code> was removed, because now every
application has default session initialization method.</p>
<p>File <code class="docutils literal"><span class="pre">default-init.lisp</span></code> was refactored. Now it provides default
method for <code class="docutils literal"><span class="pre">weblocks/session:init</span></code> generic and <code class="docutils literal"><span class="pre">:around</span></code> method for
same generic, which allows end user just to return a string or a
function from his <code class="docutils literal"><span class="pre">init</span></code> method.</p>
<p>Now user can return any string or function from his method
<code class="docutils literal"><span class="pre">weblocks/session:init</span></code> and it will be passed to a new generic
<code class="docutils literal"><span class="pre">weblocks/widget:create-widget-from</span></code> to create a root widget. You can
also define <code class="docutils literal"><span class="pre">create-widget-from</span></code> for you custom types.</p>
</div>
<div class="section" id="debug">
<h3>Debug<a class="headerlink" href="#debug" title="Permalink to this headline">¶</a></h3>
<p>Function <code class="docutils literal"><span class="pre">weblocks/debug:on</span></code> now turns on mode when Weblocks does not
intercept unhandled conditions, but calls an interactive debugger.</p>
</div>
<div class="section" id="removals">
<h3>Removals<a class="headerlink" href="#removals" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">session-name-string-pair</span></code> this function was removed in previous
releases, but didn&#8217;t find it&#8217;s way to the changelog, still used in
some older tests not ported to the Rove.</li>
<li>Macro <code class="docutils literal"><span class="pre">defrender</span></code> was removed.</li>
</ul>
</div>
</div>
<div class="section" id="id13">
<h2>0.24.0 (2018-01-29)<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>All rendering code was refactored.</p>
<p>Macroses <code class="docutils literal"><span class="pre">with-html</span></code> and <code class="docutils literal"><span class="pre">with-html-to-string</span></code> replaced
with <code class="docutils literal"><span class="pre">weblocks.html:with-html</span></code> and <code class="docutils literal"><span class="pre">weblocks.html:with-html-string</span></code>.
Stream <code class="docutils literal"><span class="pre">*weblocks-output-stream*</span></code> was moved to
<code class="docutils literal"><span class="pre">weblocks.html::*stream*</span></code> and is not external anymore. Please, don&#8217;t
use it directly.</p>
<div class="section" id="widget-refactorings">
<h3>Widget refactorings<a class="headerlink" href="#widget-refactorings" title="Permalink to this headline">¶</a></h3>
<p>Procedure <code class="docutils literal"><span class="pre">update-widget-tree</span></code> was removed and not widgets can&#8217;t
change html header&#8217;s tags, description, title, etc. If you need this,
change them in the <code class="docutils literal"><span class="pre">render</span></code> method.</p>
<p>Macro <code class="docutils literal"><span class="pre">root-widget</span></code> was removed and replaced with function
<code class="docutils literal"><span class="pre">weblocks.widgets.root:get</span></code>.</p>
</div>
<div class="section" id="request-level">
<h3>Request level<a class="headerlink" href="#request-level" title="Permalink to this headline">¶</a></h3>
<p>Functions <code class="docutils literal"><span class="pre">post-action-redirect</span></code>, <code class="docutils literal"><span class="pre">post-render-redirect</span></code> and
<code class="docutils literal"><span class="pre">initial-request-p</span></code> were removed from <code class="docutils literal"><span class="pre">weblocks</span></code> package.</p>
<p>Function <code class="docutils literal"><span class="pre">pure-request-p</span></code> was moved to <code class="docutils literal"><span class="pre">weblocks.request</span></code> package.</p>
<p>Variable <code class="docutils literal"><span class="pre">*json-content-type*</span></code> was removed.</p>
<p>Variable <code class="docutils literal"><span class="pre">*latest-request*</span></code> was moved to
<code class="docutils literal"><span class="pre">weblocks.debug:*latest-request*</span></code>.</p>
<p>Functions <code class="docutils literal"><span class="pre">parse-location-hash</span></code>, <code class="docutils literal"><span class="pre">ajax-request-p</span></code> were moved to
<code class="docutils literal"><span class="pre">weblocks.request</span></code> package.</p>
<p>Function <code class="docutils literal"><span class="pre">redirect</span></code> was moved to <code class="docutils literal"><span class="pre">weblocks.response:redirect</span></code>.
Functionality, related to opening another window instead of redirection
or deferring redirection until the end of action or rendering was
removed.</p>
</div>
<div class="section" id="request-handler">
<h3>Request handler<a class="headerlink" href="#request-handler" title="Permalink to this headline">¶</a></h3>
<p>Functions <code class="docutils literal"><span class="pre">remove-duplicate-dirty-widgets</span></code>,
<code class="docutils literal"><span class="pre">update-location-hash-dependents</span></code> and <code class="docutils literal"><span class="pre">update-widget-tree</span></code> were
removed.</p>
<p>Call to <code class="docutils literal"><span class="pre">weblocks::update-dialog-on-request</span></code> from
<code class="docutils literal"><span class="pre">handle-client-request</span></code> was commented.</p>
</div>
<div class="section" id="error-handler">
<h3>Error handler<a class="headerlink" href="#error-handler" title="Permalink to this headline">¶</a></h3>
<p>Generic method <code class="docutils literal"><span class="pre">weblocks/error-handler:on-error</span></code> now accepts two
arguments - application object and condition.</p>
</div>
<div class="section" id="application-level">
<h3>Application level<a class="headerlink" href="#application-level" title="Permalink to this headline">¶</a></h3>
<p>All code from <code class="docutils literal"><span class="pre">uri-parameters-slotmap.lisp</span></code> was removed.</p>
<p>All code, related to application class, was moved to the package
<code class="docutils literal"><span class="pre">weblocks.app</span></code>. Base aplication class was renamed to
<code class="docutils literal"><span class="pre">weblocks.app:app</span></code>, and macro for definition of the new
application was renamed to <code class="docutils literal"><span class="pre">weblocks.app:defapp</span></code>.</p>
<p>All code related to application&#8217;s metaclass, was moved to
the package <code class="docutils literal"><span class="pre">weblocks.app-mop</span></code>. Metaclass was renamed to
<code class="docutils literal"><span class="pre">weblocks.app-mop:app-class</span></code>.</p>
<p>Application&#8217;s slot <code class="docutils literal"><span class="pre">html-indent-p</span></code> and corresponding accessor
<code class="docutils literal"><span class="pre">weblocks-webapp-html-indent-p</span></code> were removed because now spinneret
generates non indented code.</p>
<p>Slot <code class="docutils literal"><span class="pre">init-user-session</span></code> was completely removed and replace with a generic
<code class="docutils literal"><span class="pre">weblocks.session:init</span></code>.</p>
<p>These dependency related slots and accessors were removed:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">application-dependencies</span></code></li>
<li><code class="docutils literal"><span class="pre">weblocks-webapp-application-dependencies</span></code></li>
<li><code class="docutils literal"><span class="pre">bundle-dependency-types</span></code></li>
<li><code class="docutils literal"><span class="pre">version-dependency-types</span></code></li>
<li><code class="docutils literal"><span class="pre">gzip-dependency-types</span></code></li>
</ul>
<p>And macro for defining a special readers for them was removed as well:
<code class="docutils literal"><span class="pre">def-debug-p-slot-readers</span></code>.</p>
<p>Also, these arguments to <code class="docutils literal"><span class="pre">defapp</span></code> was removed:
<code class="docutils literal"><span class="pre">:ignore-default-dependencies</span></code>, <code class="docutils literal"><span class="pre">:dependencies</span></code></p>
<p>Function <code class="docutils literal"><span class="pre">update-thread-status</span></code> and method <code class="docutils literal"><span class="pre">webapp-update-thread-status</span></code>
were removed.</p>
<p>Function <code class="docutils literal"><span class="pre">get-webapps-for-class</span></code> was renamed to <code class="docutils literal"><span class="pre">app-active-p</span></code> and
now returns <code class="docutils literal"><span class="pre">t</span></code> if application of given class is already active.</p>
<p>Function <code class="docutils literal"><span class="pre">start-webapp</span></code> was renamed to <code class="docutils literal"><span class="pre">weblocks.app:start</span></code>.</p>
<p>Function <code class="docutils literal"><span class="pre">get-webapp</span></code> was renamed to <code class="docutils literal"><span class="pre">get-active-app</span></code> and optional
argument <code class="docutils literal"><span class="pre">error-p</span></code> was renamed to keyword argument <code class="docutils literal"><span class="pre">signal-error</span></code>.</p>
<p>Function <code class="docutils literal"><span class="pre">find-app</span></code> was removed.</p>
<p>Function <code class="docutils literal"><span class="pre">in-webapp</span></code> was moved to <code class="docutils literal"><span class="pre">weblocks.debug:in-app</span></code>.</p>
<p>Variable <code class="docutils literal"><span class="pre">*default-webapp*</span></code> was removed.</p>
<p>Variable <code class="docutils literal"><span class="pre">*active-webapps*</span></code> was renamed to
<code class="docutils literal"><span class="pre">weblocks.app::*active-apps*</span></code> and made internal. Use
<code class="docutils literal"><span class="pre">weblocks.app:get-active-apps</span></code> function.</p>
<p>Reader <code class="docutils literal"><span class="pre">weblocks-webapp-prefix</span></code> was renamed to
<code class="docutils literal"><span class="pre">weblocks.app:get-prefix</span></code>.</p>
<p>Slot <code class="docutils literal"><span class="pre">default-store-name</span></code> and its accessor
<code class="docutils literal"><span class="pre">webapp-default-store-name</span></code> were removed.</p>
<p>Variable <code class="docutils literal"><span class="pre">*current-webapp*</span></code> was moved to
<code class="docutils literal"><span class="pre">weblocks.variables::*current-app*</span></code>.</p>
<p>Functions <code class="docutils literal"><span class="pre">compute-webapp-public-files-uri-prefix</span></code>,
<code class="docutils literal"><span class="pre">compute-webapp-public-files-uri-prefix</span></code>,
<code class="docutils literal"><span class="pre">compute-webapp-public-files-path</span></code>,
<code class="docutils literal"><span class="pre">make-webapp-public-file-uri</span></code>,
<code class="docutils literal"><span class="pre">weblocks-webapp-public-files-cache-time</span></code> and variable
<code class="docutils literal"><span class="pre">*default-public-files-path*</span></code> were removed because
now there is another way to serve static.</p>
<p>Function <code class="docutils literal"><span class="pre">webapp-serves-hostname</span></code> was renamed to
<code class="docutils literal"><span class="pre">weblocks.app:app-serves-hostname-p</span></code> and now accepts app as the first
argument and hostname as the second.</p>
<p>Variable <code class="docutils literal"><span class="pre">*uri-tokens*</span></code> was removed and weblocks does not set
&#8216;last-request-uri session value to all uri tokens anymore.</p>
<p>Macro <code class="docutils literal"><span class="pre">with-webapp</span></code> was moved to <code class="docutils literal"><span class="pre">weblocks.app:with-app</span></code>.</p>
<p>Function <code class="docutils literal"><span class="pre">webapp-permanent-action</span></code> was moved to
<code class="docutils literal"><span class="pre">weblocks.app-actions:get-action</span></code>.</p>
<p>Function <code class="docutils literal"><span class="pre">add-webapp-permanent-action</span></code> was moved to
<code class="docutils literal"><span class="pre">weblocks.app-actions:add-action</span></code> and <code class="docutils literal"><span class="pre">remove-webapp-permanent-action</span></code> to
<code class="docutils literal"><span class="pre">weblocks.app-actions:remove-action</span></code>.</p>
<p>Macroses <code class="docutils literal"><span class="pre">define-permanent-action</span></code> and <code class="docutils literal"><span class="pre">define-permanent-action/cc</span></code>
were moved to <code class="docutils literal"><span class="pre">weblocks.app-actions:define-action</span></code> and
<code class="docutils literal"><span class="pre">weblocks.app-actions:define-action/cc</span></code>.</p>
<p>Function <code class="docutils literal"><span class="pre">make-webapp-uri</span></code> was removed, use
<code class="docutils literal"><span class="pre">weblocks/response:make-uri</span></code> instedad.</p>
<p>Accessor <code class="docutils literal"><span class="pre">webapp-js-backend</span></code> was renamed to get-js-backend</p>
<p>These functions were moved into the separate package
<code class="docutils literal"><span class="pre">weblocks.current-app</span></code> and renamed:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">webapp-prefix</span></code> -&gt; <code class="docutils literal"><span class="pre">get-prefix</span></code>;</li>
</ul>
</div>
<div class="section" id="actions-and-commands">
<h3>Actions and commands<a class="headerlink" href="#actions-and-commands" title="Permalink to this headline">¶</a></h3>
<p>Function <code class="docutils literal"><span class="pre">weblocks.actions:add-command</span></code> was moved to
<code class="docutils literal"><span class="pre">weblocks.commands</span></code>.</p>
<p>Function <code class="docutils literal"><span class="pre">weblocks:get-request-action</span></code> was moved to
<code class="docutils literal"><span class="pre">weblocks/actions:get-request-action</span></code></p>
<p>Keyword argment <code class="docutils literal"><span class="pre">:action</span></code> was removed from action calls.</p>
</div>
<div class="section" id="javascript">
<h3>Javascript<a class="headerlink" href="#javascript" title="Permalink to this headline">¶</a></h3>
<p>Package <code class="docutils literal"><span class="pre">weblocks.js</span></code> was renamed to <code class="docutils literal"><span class="pre">weblocks/js/base</span></code>.</p>
<p>Functions <code class="docutils literal"><span class="pre">escape-script-tags</span></code>, <code class="docutils literal"><span class="pre">%js</span></code> and macroses
<code class="docutils literal"><span class="pre">with-javascript</span></code>, <code class="docutils literal"><span class="pre">with-javascript-to-string</span></code> were moved to the
package <code class="docutils literal"><span class="pre">weblocks/js/base</span></code>.</p>
</div>
<div class="section" id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p>These variables were moved from <code class="docutils literal"><span class="pre">weblocks</span></code> package to
<code class="docutils literal"><span class="pre">weblocks/variables</span></code>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">*current-page-title*</span></code></li>
<li><code class="docutils literal"><span class="pre">*current-page-keywords*</span></code></li>
<li><code class="docutils literal"><span class="pre">*current-page-headers*</span></code></li>
<li><code class="docutils literal"><span class="pre">*rewrite-for-session-urls*</span></code></li>
<li><code class="docutils literal"><span class="pre">*default-content-type*</span></code></li>
<li><code class="docutils literal"><span class="pre">*ignore-missing-actions*</span></code></li>
</ul>
</div>
<div class="section" id="symbols-moved-from-weblocks-to-other-packages">
<h3>Symbols moved from :weblocks to other packages<a class="headerlink" href="#symbols-moved-from-weblocks-to-other-packages" title="Permalink to this headline">¶</a></h3>
<div class="section" id="to-weblocks-widgets-dom">
<h4>To :weblocks/widgets/dom<a class="headerlink" href="#to-weblocks-widgets-dom" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">dom-object-mixin</span></code></li>
<li><code class="docutils literal"><span class="pre">dom-id</span></code></li>
</ul>
</div>
<div class="section" id="to-weblocks-utils-uri">
<h4>To :weblocks/utils/uri<a class="headerlink" href="#to-weblocks-utils-uri" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">request-uri-path</span></code></li>
<li><code class="docutils literal"><span class="pre">add-get-param-to-url</span></code></li>
<li><code class="docutils literal"><span class="pre">remove-parameter-from-uri</span></code></li>
</ul>
</div>
<div class="section" id="to-weblocks-linguistic-grammar">
<h4>To :weblocks/linguistic/grammar<a class="headerlink" href="#to-weblocks-linguistic-grammar" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">pluralize</span></code></li>
<li><code class="docutils literal"><span class="pre">singularize</span></code></li>
<li><code class="docutils literal"><span class="pre">proper-number-form</span></code></li>
<li><code class="docutils literal"><span class="pre">vowelp</span></code></li>
<li><code class="docutils literal"><span class="pre">consonantp</span></code></li>
<li><code class="docutils literal"><span class="pre">proper-indefinite-article</span></code></li>
<li><code class="docutils literal"><span class="pre">articlize</span></code></li>
<li><code class="docutils literal"><span class="pre">*current-locale*</span></code></li>
<li><code class="docutils literal"><span class="pre">current-locale</span></code></li>
<li><code class="docutils literal"><span class="pre">russian-proper-number-form</span></code></li>
<li><code class="docutils literal"><span class="pre">noun-vocative-to-genitive</span></code></li>
<li><code class="docutils literal"><span class="pre">*debug-words-forms*</span></code></li>
<li><code class="docutils literal"><span class="pre">*debug-words-genders*</span></code></li>
<li><code class="docutils literal"><span class="pre">determine-gender</span></code></li>
</ul>
</div>
<div class="section" id="to-weblocks-utils-warn">
<h4>To weblocks/utils/warn<a class="headerlink" href="#to-weblocks-utils-warn" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">style-warn</span></code></li>
<li><code class="docutils literal"><span class="pre">webapp-style-warning</span></code> renamed to <code class="docutils literal"><span class="pre">style-warning</span></code>.</li>
<li><code class="docutils literal"><span class="pre">non-idempotent-rendering</span></code></li>
<li><code class="docutils literal"><span class="pre">misunderstood-action</span></code></li>
</ul>
</div>
<div class="section" id="to-weblocks-actions">
<h4>To weblocks/actions<a class="headerlink" href="#to-weblocks-actions" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">function-or-action-&gt;action</span></code></li>
<li><code class="docutils literal"><span class="pre">make-action</span></code></li>
<li><code class="docutils literal"><span class="pre">generate-action-code</span></code></li>
</ul>
</div>
</div>
<div class="section" id="id14">
<h3>Removals<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>To make Weblocks core smaller, many files were removed: <code class="docutils literal"><span class="pre">views</span></code>, <code class="docutils literal"><span class="pre">widgets</span></code>,
<code class="docutils literal"><span class="pre">html-parts</span></code>, <code class="docutils literal"><span class="pre">utilities</span></code>.</p>
<p>Systems <code class="docutils literal"><span class="pre">weblocks-util</span></code>, <code class="docutils literal"><span class="pre">weblocks-testutils</span></code> were removed.</p>
<p>Accessor <code class="docutils literal"><span class="pre">dom-class</span></code> and generic function <code class="docutils literal"><span class="pre">dom-classes</span></code> were removed
and replaced with generic function <code class="docutils literal"><span class="pre">weblocks/widget:get-css-classes</span></code>.</p>
<p>Generic function <code class="docutils literal"><span class="pre">weblocks:handle-error-condition</span></code> was removed.</p>
<p>Variable <code class="docutils literal"><span class="pre">*dirty-widgets*</span></code> was removed along with
<code class="docutils literal"><span class="pre">render-dirty-widgets</span></code> function.</p>
</div>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p>Rendering of remote (non cached) dependencies was fixed.</p>
</div>
</div>
<div class="section" id="id15">
<h2>0.23.0 (2018-01-11)<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Symbol <code class="docutils literal"><span class="pre">weblocks.routes:*routes*</span></code> is not external anymore.
Use <code class="docutils literal"><span class="pre">weblocks.routes:add-route</span></code> and <code class="docutils literal"><span class="pre">weblocks.routes:get-route</span></code>
to add new routes and to search a route matched on a path.</li>
<li>Fixed getting the rendered widgets in <code class="docutils literal"><span class="pre">weblocks.widget:update</span></code>
method when making <code class="docutils literal"><span class="pre">:update-widget</span></code> or <code class="docutils literal"><span class="pre">:insert-widget</span> <span class="pre">(before)</span></code>
commands.</li>
<li>Temporary added method <code class="docutils literal"><span class="pre">weblocks::child-of-p</span></code> for new type of
widget. This should fix some issues, with widgets updating.</li>
</ul>
</div>
<div class="section" id="id16">
<h2>0.22.2 (2018-01-07)<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Class <code class="docutils literal"><span class="pre">weblocks.widget:widget</span></code> was exported, to make possible to
define widgets based on it and some mixins.</li>
</ul>
</div>
<div class="section" id="id17">
<h2>0.22.1 (2018-01-07)<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Code broken in previos release was fixed.</li>
</ul>
</div>
<div class="section" id="id18">
<h2>0.22.0 (2018-01-06)<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<p>Most functions from <code class="docutils literal"><span class="pre">weblocks.request</span></code> were refactored and renamed:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">request-parameters</span></code> -&gt; <code class="docutils literal"><span class="pre">get-parameters</span></code>;</li>
<li><code class="docutils literal"><span class="pre">request-parameter</span></code> -&gt; <code class="docutils literal"><span class="pre">get-parameter</span></code>;</li>
<li><code class="docutils literal"><span class="pre">request-header</span></code> -&gt; <code class="docutils literal"><span class="pre">get-header</span></code>;</li>
<li><code class="docutils literal"><span class="pre">remove-request-header</span></code> -&gt; <code class="docutils literal"><span class="pre">remove-header</span></code>;</li>
<li><code class="docutils literal"><span class="pre">request-server-name</span></code> -&gt; <code class="docutils literal"><span class="pre">get-host</span></code>;</li>
<li><code class="docutils literal"><span class="pre">request-server-port</span></code> -&gt; <code class="docutils literal"><span class="pre">get-port</span></code>;</li>
<li><code class="docutils literal"><span class="pre">request-uri</span></code> -&gt; <code class="docutils literal"><span class="pre">get-uri</span></code> (and now it returns full URI with
scheme, host and port;</li>
<li><code class="docutils literal"><span class="pre">request-path-info</span></code> -&gt; <code class="docutils literal"><span class="pre">get-path</span></code> (and now it has keyword argument
<code class="docutils literal"><span class="pre">with-params</span></code> to copy behaviour of old <code class="docutils literal"><span class="pre">request-uri</span></code> and return
strings like <code class="docutils literal"><span class="pre">/some/path?with=parameters</span></code>;</li>
<li><code class="docutils literal"><span class="pre">request-method</span></code> -&gt; <code class="docutils literal"><span class="pre">get-method</span></code>.</li>
</ul>
<p>All these function now accept keyword argument <code class="docutils literal"><span class="pre">:request</span></code>. Previously
it was <code class="docutils literal"><span class="pre">&amp;optional</span></code>.</p>
<p>Another change is a new function <code class="docutils literal"><span class="pre">weblocks.response:make-uri</span></code>. It can
be used to build new uri, based on the uri of the current request. This
can be useful when embedding links into emails, for example.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>These changes require a newer version of Lack.</p>
<p>I&#8217;ve made a pull request <a class="reference external" href="https://github.com/fukamachi/lack/pull/31">https://github.com/fukamachi/lack/pull/31</a>
it is not merged yet, so, alternative version of Lack can be used, by
installing it using Qlot, from here:</p>
<p class="last"><a class="reference external" href="https://github.com/40ants/lack">https://github.com/40ants/lack</a></p>
</div>
</div>
<div class="section" id="id19">
<h2>0.21.0 (2018-01-01)<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Macro <code class="docutils literal"><span class="pre">weblocks.session:get-value</span></code> was replaced with a regular
function.</li>
<li>Function <code class="docutils literal"><span class="pre">weblocks.session:set-value</span></code> was removed and replaced with
a setter <code class="docutils literal"><span class="pre">(setf</span> <span class="pre">get-value)</span></code>.</li>
</ul>
</div>
<div class="section" id="id20">
<h2>0.20.1 (2017-12-20)<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Removed debug these debug messages from client-side JS:<ul>
<li>LOADED;</li>
<li>Starting AJAX;</li>
<li>Stopping AJAX progress;</li>
<li>Some AJAX error;</li>
<li>Action success.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id21">
<h2>0.20.0 (2017-12-15)<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Package <code class="docutils literal"><span class="pre">weblocks.debug</span></code> now does not export <code class="docutils literal"><span class="pre">*on</span></code> variable,
but provides three functions <code class="docutils literal"><span class="pre">on</span></code>, <code class="docutils literal"><span class="pre">off</span></code> and <code class="docutils literal"><span class="pre">status</span></code>.</p>
</li>
<li><p class="first">New method <code class="docutils literal"><span class="pre">weblocks.server:serve-static-file</span></code> was introduced.
It can be used to create static routes which will respond with
file&#8217;s content. For example, you could add this to your app&#8217;s
<code class="docutils literal"><span class="pre">initialize-instance</span></code> method:</p>
<div class="code common-lisp highlight-common-lisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">weblocks.server:serve-static-file</span>
   <span class="s">&quot;/favicon.png&quot;</span>
   <span class="p">(</span><span class="nv">asdf:system-relative-pathname</span> <span class="ss">:app</span> <span class="s">&quot;favicon.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="id22">
<h2>0.19.2 (2017-11-29)<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Now weblocks rebinds <code class="docutils literal"><span class="pre">*random-state*</span></code> to itself for each request to
allow it to use <code class="docutils literal"><span class="pre">setf</span></code> and change <code class="docutils literal"><span class="pre">*random-state*</span></code> until the end
of request processing.</li>
</ul>
</div>
<div class="section" id="id23">
<h2>0.19.1 (2017-11-23)<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Dirty widgets rendering was fixed.</li>
</ul>
</div>
<div class="section" id="id24">
<h2>0.19.0 (2017-11-13)<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Variable <code class="docutils literal"><span class="pre">*expired-action-handler*</span></code>, method
<code class="docutils literal"><span class="pre">expired-action-handler</span></code> and function
<code class="docutils literal"><span class="pre">default-expired-action-handler</span></code> were replaced with method
<code class="docutils literal"><span class="pre">weblocks.actions:on-missing-action</span></code>.</li>
<li>Now we are trying to call action only if action&#8217;s name was given.</li>
<li>Old method <code class="docutils literal"><span class="pre">weblocks:handle-client-request</span> <span class="pre">((app</span> <span class="pre">weblocks-webapp))</span></code>
was removed. Look at it&#8217;s newer version in <code class="docutils literal"><span class="pre">weblocks.request-handler</span></code>.</li>
</ul>
</div>
<div class="section" id="id25">
<h2>0.18.0 (2017-11-12)<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Commented out call to <code class="docutils literal"><span class="pre">update-widget-tree</span></code> inside of <code class="docutils literal"><span class="pre">(setf</span>
<span class="pre">widget-children)</span></code>, because it breaks on
<code class="docutils literal"><span class="pre">(get-widgets-by-type</span> <span class="pre">'selector</span> <span class="pre">:root</span> <span class="pre">obj)</span></code> sometimes. Seems this is
because I&#8217;ve removed selector&#8217;s code previously.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Probably parent/children handling code will be removed soon.</p>
</div>
</li>
<li><p class="first">Backtrace printing code was replaced with direct usage of
<code class="docutils literal"><span class="pre">trivial-backtrace:print-backtrace</span></code>.</p>
</li>
<li><p class="first">Call to <code class="docutils literal"><span class="pre">prepare-hooks</span></code> was moved from <code class="docutils literal"><span class="pre">weblocks.request-handler:handle-client-request</span></code>
to the the weblocks.server:handler-request, to fix session hooks processing when
<code class="docutils literal"><span class="pre">:process-request</span></code> hook is called.</p>
</li>
</ul>
</div>
<div class="section" id="id26">
<h2>0.17.2 (2017-11-11)<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Error handling code was fixed. It was broken in 0.17.1 and prevented
system loading.</li>
</ul>
</div>
<div class="section" id="id27">
<h2>0.17.1 (2017-11-11)<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Fixed error handling when debug mode is &#8220;off&#8221;. Now weblocks returns
result of <code class="docutils literal"><span class="pre">(weblocks.error-handler:on-error</span> <span class="pre">app)</span></code> call.</li>
</ul>
</div>
<div class="section" id="id28">
<h2>0.17.0 (2017-11-11)<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Added a <code class="docutils literal"><span class="pre">weblocks.actions</span></code> package.</li>
<li>Also, a <code class="docutils literal"><span class="pre">commands</span></code> were introduced. Commands describe remote calls
which have to be applied on a client as a result of action&#8217;s
execution. Previously, weblocks used similar technic to replace dirty
widgets and to execute some javascript code before or after
replacement. The new mechanism of &#8220;commands&#8221; is more generic and uses
the JSON-RPC to pass function name and parameters from backend to
client-side.</li>
<li>Added <code class="docutils literal"><span class="pre">weblocks.session:in-session-p</span></code> function which returns <code class="docutils literal"><span class="pre">t</span></code>
if session data can be retrived or stored without error.</li>
<li>Now function <code class="docutils literal"><span class="pre">initiateActionWithArgsAndCallback</span></code> send arguments as
JSON payload. This allows to send any datastructures as action&#8217;s params.</li>
<li>Function <code class="docutils literal"><span class="pre">weblocks.response:send-script</span></code> was changed to use new
mechanizm with commands. When you send script from the action, it will
add a command <code class="docutils literal"><span class="pre">:execute-code</span></code> to the stack. All commands are
executed in same order as they were added. If you want some code to be
executed before widget update, just execute <code class="docutils literal"><span class="pre">send-code</span></code> before
<code class="docutils literal"><span class="pre">weblocks.widget:update</span></code>.</li>
</ul>
</div>
<div class="section" id="id29">
<h2>0.16.0 (2017-11-04)<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">New package was introduced - <code class="docutils literal"><span class="pre">weblocks.widget</span></code> it contains a new
<code class="docutils literal"><span class="pre">widget</span></code> class with simplified rendering based on <code class="docutils literal"><span class="pre">spinneret</span></code>
templating library.</p>
</li>
<li><p class="first">Now class <code class="docutils literal"><span class="pre">route</span></code> is exported from <code class="docutils literal"><span class="pre">weblocks.routes</span></code> and should be
used instead of <code class="docutils literal"><span class="pre">routes:route</span></code>.</p>
</li>
<li><p class="first">New package <code class="docutils literal"><span class="pre">weblocks.error-handler</span></code> was introduced. It contains a
<code class="docutils literal"><span class="pre">on-error</span></code> generic method which is called when some unhandled error
raise by application.</p>
</li>
<li><p class="first">Fixed issue of adding multuple routes mapped to the same path. Now if
url mapper already have a route all subsequent attempts to add a route
with same path are ignored.</p>
</li>
<li><p class="first">Fixed error:</p>
<div class="highlight-common-lisp"><div class="highlight"><pre><span></span>Undefined function WEBLOCKS:WEBAPP-SESSION-KEY called with arguments
(#&lt;APP::APP #x3020052F01DD&gt;)
</pre></div>
</div>
</li>
<li><p class="first">Fixed <code class="docutils literal"><span class="pre">Content-Type</span></code> of the default 500 page. Previously it was
<code class="docutils literal"><span class="pre">plain/text</span></code> and browser didn&#8217;t undestand that and downloaded the
file.</p>
<p>Now <code class="docutils literal"><span class="pre">Content-Type</span></code> is <code class="docutils literal"><span class="pre">text/plain</span></code>.</p>
</li>
</ul>
</div>
<div class="section" id="id30">
<h2>0.15.0 (2017-11-03)<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Now weblocks does not checks if all tokens from URL were consumed by
app during root widget rendering. Previously it returned 404 if some
token weren&#8217;t consumed. Implement this logic in your app if needed.</p>
</li>
<li><p class="first">Macro <code class="docutils literal"><span class="pre">assert-hooks-called</span></code> was changed to return hooks in the order
they were called. Also, now it waits hooks description as a DSL,
like:</p>
<div class="code common-lisp highlight-common-lisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">assert-hooks-called</span>
  <span class="p">(</span><span class="ss">:fact-created</span> <span class="nv">contact</span> <span class="s">&quot;vasya@pupkin.com&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="ss">:fact-removed</span> <span class="nv">contact</span> <span class="s">&quot;vasya@pupkin.com&quot;</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p class="first">New system <code class="docutils literal"><span class="pre">weblocks-testutils</span></code> was introduced. It
compiles <code class="docutils literal"><span class="pre">weblocks.t.utils</span></code> package which macroses useful for
unittesting.</p>
<p>Also, a new macro <code class="docutils literal"><span class="pre">catch-hooks</span></code> was added to check if some
hooks were called during a unittest.</p>
</li>
<li><p class="first">Now weblocks does not open a new tab or window on 500 error
during an action execution.</p>
</li>
</ul>
</div>
<div class="section" id="id31">
<h2>0.14.4 (2017-10-07)<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>No more <code class="docutils literal"><span class="pre">declaim</span> <span class="pre">optimize</span></code> in different places. These
declarations changed compiler&#8217;s settings at unexpected moments.</li>
<li>Fixed error happened when &#8220;File not found&#8221;, and now
<code class="docutils literal"><span class="pre">with-hook</span></code> macro returns the value of the last form&#8217;s evaluation.</li>
</ul>
</div>
<div class="section" id="id32">
<h2>0.14.3 (2017-09-23)<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Default method of <code class="docutils literal"><span class="pre">render-page</span></code> was fixed to really wrap
page with <code class="docutils literal"><span class="pre">&lt;html&gt;...</span></code> block.</li>
<li>Fixed a way how weblocks.debug:<em>latest-session</em> is
processed.</li>
<li>Function <code class="docutils literal"><span class="pre">weblocks.request:remove-request-header</span></code> now
returns a new instance of request object and does not modify the
original request. This fixes issue in <code class="docutils literal"><span class="pre">weblocks-websocket</span></code>.</li>
</ul>
</div>
<div class="section" id="id33">
<h2>0.14.2 (2017-09-22)<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Added package <code class="docutils literal"><span class="pre">weblocks.debug</span></code> and keeping latest
session was rewritten using <code class="docutils literal"><span class="pre">:process-request</span></code> hook.</li>
</ul>
</div>
<div class="section" id="id34">
<h2>0.14.1 (2017-09-22)<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Added function <code class="docutils literal"><span class="pre">weblocks.request:remove-request-header</span></code>.</li>
<li>Added a hook <code class="docutils literal"><span class="pre">(:reset-session</span> <span class="pre">session)</span></code>, which is
called around a code for clearing given session. Right now it is
called only from <code class="docutils literal"><span class="pre">weblocks.sessions:reset-latest-session</span></code>.</li>
</ul>
</div>
<div class="section" id="id35">
<h2>0.14.0 (2017-09-20)<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">html</span></code>, <code class="docutils literal"><span class="pre">menu</span></code>, <code class="docutils literal"><span class="pre">suggest</span></code> and <code class="docutils literal"><span class="pre">repl</span></code> utilities
were excluded.</p>
</li>
<li><p class="first">Code which was in <code class="docutils literal"><span class="pre">request-handler.lisp</span></code>, was excluded
from build and partly moved to <code class="docutils literal"><span class="pre">request-handler2.lisp</span></code>.</p>
</li>
<li><p class="first">Added <code class="docutils literal"><span class="pre">:stop-weblocks</span></code> hook.</p>
</li>
<li><p class="first">Misc helper for repl were removed: <code class="docutils literal"><span class="pre">sessions</span></code>,
<code class="docutils literal"><span class="pre">in-session</span></code> and <code class="docutils literal"><span class="pre">pt</span></code>. May be the will be restored in separate
package.</p>
</li>
<li><p class="first">Page boilerplate rendering method <code class="docutils literal"><span class="pre">render-page</span></code> now
does not use complex templating with contextes.</p>
</li>
<li><p class="first">Symbols refactoring:
* <code class="docutils literal"><span class="pre">*style-warn-on-circular-dirtying*</span></code> variable -&gt;</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">weblocks.variables</span></code>;</p>
</div></blockquote>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">*style-warn-on-late-propagation*</span></code> variable -&gt;
<code class="docutils literal"><span class="pre">weblocks.variables</span></code>;</li>
<li><code class="docutils literal"><span class="pre">gen-id</span></code> function -&gt; <code class="docutils literal"><span class="pre">weblocks.session</span></code>;</li>
<li><code class="docutils literal"><span class="pre">send-script</span></code> function -&gt; <code class="docutils literal"><span class="pre">weblocks.response</span></code>;</li>
<li><code class="docutils literal"><span class="pre">with-html-form</span></code> macro -&gt; <code class="docutils literal"><span class="pre">weblocks-ui</span></code>;</li>
<li><code class="docutils literal"><span class="pre">*approved-return-codes*</span></code> variable -&gt; <code class="docutils literal"><span class="pre">weblocks.variables</span></code>;</li>
<li><code class="docutils literal"><span class="pre">handle-ajax-request</span></code> method -&gt; <code class="docutils literal"><span class="pre">weblocks.request-handler</span></code>;</li>
<li><code class="docutils literal"><span class="pre">update-location-hash-dependents</span></code> function -&gt;
<code class="docutils literal"><span class="pre">weblocks.request-handler</span></code>.</li>
<li><code class="docutils literal"><span class="pre">render-link</span></code> function was moved to <code class="docutils literal"><span class="pre">weblocks-ui.form</span></code> in
separate system.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id36">
<h2>0.13.11 (2017-09-12)<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Added <code class="docutils literal"><span class="pre">weblocks.hooks:call-hook</span></code> helper.</li>
<li>Now <code class="docutils literal"><span class="pre">call-next-hook</span></code> is called automatically if it
wasn&#8217;t called explicitly.</li>
</ul>
</div>
<div class="section" id="id37">
<h2>0.13.10 (2017-09-06)<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h2>
<div class="section" id="changes-in-weblocks-request-hooks">
<h3>Changes in weblocks.request-hooks:<a class="headerlink" href="#changes-in-weblocks-request-hooks" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Package <code class="docutils literal"><span class="pre">weblocks.request-hooks</span></code> was renamed to <code class="docutils literal"><span class="pre">weblocks.hooks</span></code>.</p>
</li>
<li><p class="first">Macro <code class="docutils literal"><span class="pre">with-dynamic-hooks</span></code> was renamed to <code class="docutils literal"><span class="pre">with-hook</span></code>.</p>
</li>
<li><p class="first">Functions add-application-hook, add-session-hook, add-request-hook
became a macroses and their argument lists were changed. Now the
should be used like:</p>
<div class="highlight-lisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">weblocks.hooks:add-session-hook</span>
         <span class="ss">:some-hook</span>
         <span class="nv">my-beautiful-callback</span> <span class="p">(</span><span class="nv">param</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">do-something-useful-with</span> <span class="nv">param</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">weblocks.request-hooks:eval-hooks</span></code> was renamed to
<code class="docutils literal"><span class="pre">weblocks.hooks:call</span></code> and now can be called with params:</p>
<div class="highlight-lisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">weblocks.hooks:call</span> <span class="ss">:some-hook</span>
      <span class="nv">first-param</span>
      <span class="nv">second-param</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="id38">
<h2>0.13.10 (2017-09-06)<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Added <code class="docutils literal"><span class="pre">:handle-request</span></code> dynamic hook called around request handling code.</p>
<p>Called when <code class="docutils literal"><span class="pre">weblocks.request:*request*</span></code> and <code class="docutils literal"><span class="pre">weblocks.session:*session*</span></code> are already bound.</p>
</li>
</ul>
</div>
<div class="section" id="id39">
<h2>0.13.9 (2017-09-02)<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Added integrity field for remove javascript dependencies.
Also, <code class="docutils literal"><span class="pre">get-cross-origin</span></code> and <code class="docutils literal"><span class="pre">:cross-origin</span></code> were removed to
<code class="docutils literal"><span class="pre">get-crossorigin</span></code> and <code class="docutils literal"><span class="pre">:crossorigin</span></code>, to conform the html
attibute&#8217;s spelling.</li>
</ul>
</div>
<div class="section" id="id40">
<h2>0.13.8 (2017-09-02)<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Fixed error on <code class="docutils literal"><span class="pre">(weblocks:redirect...)</span></code> call.</li>
<li>Fixed dependency handling in ajax requests.</li>
<li>Now if unhandled exception occure, Woo&#8217;s handler remains
working. Previously, handler&#8217;s thread shut down on any unhandled exception.</li>
<li>Ajax progress now does not inserted into the document,
but if element with id <code class="docutils literal"><span class="pre">ajax-progress</span></code> is present, it will be shown
and hidden by jQuery&#8217;s <code class="docutils literal"><span class="pre">.show</span></code> and <code class="docutils literal"><span class="pre">.hide</span></code> methods. Also, they
take optional speed parameters from <code class="docutils literal"><span class="pre">data-*</span></code> attributes
<code class="docutils literal"><span class="pre">data-show-speed</span></code> and <code class="docutils literal"><span class="pre">data-hide-speed</span></code>.</li>
<li>Reformatted documentation. Started to <a class="reference external" href="http://keepachangelog.com/">keep a changelog</a>.</li>
</ul>
</div>
<div class="section" id="id41">
<h2>0.13.7 (2017-04-15)<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Previous history wasn&#8217;t tracked.</li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/changelog.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2017, group of lisp hackers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.<br/>
    </p>
  </div>
</footer>
  </body>
</html>